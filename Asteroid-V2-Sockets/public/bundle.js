!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);class i{constructor(t){this.game=t}handleInputs(){}render(t){}}class n{constructor(t){this.points=t.slice(0)}rotate(t){const e=Math.cos(t),s=Math.sin(t);for(let t=0;t<this.points.length;t+=2){const i=this.points[t],n=this.points[t+1];this.points[t]=e*i-s*n,this.points[t+1]=s*i+e*n}}scale(t){for(let e=0;e<this.points.length;e++)this.points[e]*=t}hasPoints(t,e,s,i){let n=!1;const o=this.points,r=o.length;for(let a=0,h=r-2;a<r;a+=2){const r=o[a]+t,c=o[h]+t,d=o[a+1]+e,l=o[h+1]+e;d>i!=l>i&&s<(c-r)*(i-d)/(l-d)+r&&(n=!n),h=a}return n}}class o extends n{draw(t){this.visible&&(t.drawPolygon(this,this.x,this.y),this.drawFlames&&t.drawPolygon(this.flames,this.x,this.y))}}class r extends i{render(t){t.clearAll(),t.vectorText(this.score,3,20,10);for(let e=0;e<this.lives;e+=1){const s=30+15*e;t.drawPolygon(this.lifePolygon,s,45)}this.bullets.forEach(e=>e.draw(t)),this.asteroids.forEach(e=>{e.draw(t)}),this.ship.draw(t)}}var a={ASTEROIDS:[[0,-2,2,-4,4,-2,3,0,4,2,1,4,-2,4,-4,2,-4,-2,-2,-4,0,-2],[0,-3,-2,-4,-4,-2,-3,0,-4,2,-2,4,0,3,2,4,4,2,3,0,4,-2,2,-4,0,-3],[0,1,0,4,2,4,4,1,4,-1,2,-5,-2,-5,-5,-2,-3,-1,-5,0,-2,4,0,1],[1,0,4,-1,4,-2,1,-4,-1,-4,0,-2,-3,-2,-3,1,-1,4,1,3,2,4,4,2,1,0],[0,-4,-2,-4,-1,-2,-4,-2,-3,0,-4,3,0,4,3,2,4,-1,2,-2,3,-3,0,-4],[-2,-4,2,-4,4,-2,4,2,2,4,-2,4,-4,2,-4,-2,-2,-4]],SHIP:[6,0,-3,-3,-2,0,-3,3,6,0],FLAMES:[-2,0,-3,-1,-5,0,-3,1,-2,0],GUN:[-2,-1,-2,1,-1,2,1,2,2,1,2,-1,1,-1,1,-4,-1,-4,-1,-1,-2,-1],LETTERS:[[0,6,0,2,2,0,4,2,4,4,0,4,4,4,4,6],[0,3,0,6,2,6,3,5,3,4,2,3,0,3,0,0,2,0,3,1,3,2,2,3],[4,0,0,0,0,6,4,6],[0,0,0,6,2,6,4,4,4,2,2,0,0,0],[4,0,0,0,0,3,3,3,0,3,0,6,4,6],[4,0,0,0,0,3,3,3,0,3,0,6],[4,2,4,0,0,0,0,6,4,6,4,4,2,4],[0,0,0,6,0,3,4,3,4,0,4,6],[0,0,4,0,2,0,2,6,4,6,0,6],[4,0,4,6,2,6,0,4],[3,0,0,3,0,0,0,6,0,3,3,6],[0,0,0,6,4,6],[0,6,0,0,2,2,4,0,4,6],[0,6,0,0,4,6,4,0],[0,0,4,0,4,6,0,6,0,0],[0,6,0,0,4,0,4,3,0,3],[0,0,0,6,2,6,3,5,4,6,2,4,3,5,4,4,4,0,0,0],[0,6,0,0,4,0,4,3,0,3,1,3,4,6],[4,0,0,0,0,3,4,3,4,6,0,6],[0,0,4,0,2,0,2,6],[0,0,0,6,4,6,4,0],[0,0,2,6,4,0],[0,0,0,6,2,4,4,6,4,0],[0,0,4,6,2,3,4,0,0,6],[0,0,2,2,4,0,2,2,2,6],[0,0,4,0,0,6,4,6]],NUMBERS:[[0,0,0,6,4,6,4,0,0,0],[2,0,2,6],[0,0,4,0,4,3,0,3,0,6,4,6],[0,0,4,0,4,3,0,3,4,3,4,6,0,6],[0,0,0,3,4,3,4,0,4,6],[4,0,0,0,0,3,4,3,4,6,0,6],[0,0,0,6,4,6,4,3,0,3],[0,0,4,0,4,6],[0,3,4,3,4,6,0,6,0,0,4,0,4,3],[4,3,0,3,0,0,4,0,4,6]]};class h{constructor(t,e){this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=e,this.ctx=function(t){return t.width=t.canvas.width,t.height=t.canvas.height,t.drawPolygon=function(t,e,s){const{points:i}=t;this.beginPath(),this.moveTo(i[0]+e,i[1]+s);for(let t=2;t<i.length;t+=2)this.lineTo(i[t]+e,i[t+1]+s);this.stroke()},t.clearAll=function(){this.clearRect(0,0,this.width,this.height)},t.ACODE="A".charCodeAt(0),t.ZCODE="0".charCodeAt(0),t.SCODE=" ".charCodeAt(0),t.vectorText=function(t,e,s,i){t=t.toString().toUpperCase().split("");const n=6*e;"number"!=typeof s&&(s=Math.round((this.width-t.length*n)/2)),s+=.5,i+=.5,t.forEach(t=>{const o=t.charCodeAt(0);if(o===this.SCODE)return void(s+=n);let r=null;r=o-this.ACODE>=0?a.LETTERS[o-this.ACODE]:a.NUMBERS[o-this.ZCODE],this.beginPath(),this.moveTo(r[0]*e+s,r[1]*e+i);for(let t=2;t<r.length;t+=2)this.lineTo(r[t]*e+s,r[t+1]*e+i);this.stroke(),s+=n})},t}(this.canvas.getContext("2d")),document.body.appendChild(this.canvas)}animate(t){const e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,s=()=>{t(),e(s)};e(s)}}var c={NO_CHANGE:0,MENU:1,GAME:2,END:3};class d extends n{constructor(t,e,s,i){super(t),this.maxX=640,this.maxY=480,this.x=s,this.y=i,this.scale(e),this.rotationSpeed=.02*(Math.random()+1);const n=2*Math.PI*Math.random(),o=Math.random()+1;this.velocity={x:o*Math.cos(n),y:o*Math.sin(n)}}update(){this.x+=this.velocity.x,this.y+=this.velocity.y,this.x>this.maxX+6*this.size?this.x=-6*this.size:this.x<-6*this.size&&(this.x=this.maxX+6*this.size),this.y>this.maxY+6*this.size?this.y=-6*this.size:this.y<-6*this.size&&(this.y=this.maxY+6*this.size),this.rotate(this.rotationSpeed)}draw(t){t.drawPolygon(this,this.x,this.y)}}class l extends n{draw(t){t.beginPath(),t.moveTo(this.prevx,this.prevy),t.lineTo(this.x,this.y),t.stroke()}}class u{constructor(t){this.keys={},this.down={},this.pressed={};for(const e in t){const s=t[e];this.keys[s]=e,this.down[e]=!1,this.pressed[e]=!1}document.addEventListener("keydown",t=>{this.keys[t.keyCode]&&!1===this.down[this.keys[t.keyCode]]&&socket.emit("keyDown",t.keyCode)}),document.addEventListener("keyup",t=>{this.keys[t.keyCode]&&socket.emit("keyUp",t.keyCode)})}isDown(t){return this.down[t]}isPressed(t){return!this.pressed[t]&&(!!this.down[t]&&(this.pressed[t]=!0,this.pressed[t]))}}const p=new Audio("./../sounds/fire.wav"),y=(new Audio("./../sounds/thrust.wav"),new Audio("./../sounds/bangLarge.wav")),f=new Audio("./../sounds/bangMedium.wav"),w=new Audio("./../sounds/bangSmall.wav");(new class{constructor(){this.canvas=new h(640,480),this.input=new u({left:37,up:38,right:39,down:40,spacebar:32}),this.canvas.ctx.strokeStyle="#fff",this.canvas.canvas.addEventListener("click",t=>{const e={x:t.offsetX,y:t.offsetY};socket.emit("fire",e)}),this.state={currentState:null,nextState:c.GAME},socket.on("fireSound",()=>{p.cloneNode(!0).play()}),socket.on("explosion",t=>{switch(t){case 8:y.cloneNode(!0).play();break;case 4:f.cloneNode(!0).play();break;case 2:w.cloneNode(!0).play()}}),socket.on("newState",t=>{this.state=JSON.parse(t),this.state.currentState.bullets&&(this.state.currentState=Object.setPrototypeOf(this.state.currentState,r.prototype),this.state.currentState.asteroids.map(t=>Object.setPrototypeOf(t,d.prototype)),this.state.currentState.ship=Object.setPrototypeOf(this.state.currentState.ship,o.prototype),this.state.currentState.bullets.map(t=>Object.setPrototypeOf(t,l.prototype)))})}run(){this.canvas.animate(()=>{null!==this.state.currentState&&(this.state.currentState.handleInputs(this.input),this.state.currentState.render(this.canvas.ctx))})}}).run()}]);